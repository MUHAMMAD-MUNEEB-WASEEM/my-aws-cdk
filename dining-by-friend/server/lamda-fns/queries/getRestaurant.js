"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const gremlin = require('gremlin');
const DriverRemoteConnection = gremlin.driver.DriverRemoteConnection;
const Graph = gremlin.structure.Graph;
const uri = process.env.READER;
const getRestaurant = async () => {
    let dc = new DriverRemoteConnection(`wss://${uri}/gremlin`, {});
    const graph = new Graph();
    const g = graph.traversal().withRemote(dc);
    try {
        let data = await g.V().hasLabel('restaurant').toList();
        let posts = Array();
        for (const v of data) {
            const _properties = await g.V(v.id).properties().toList();
            let post = _properties.reduce((acc, next) => {
                acc[next.label] = next.value;
                return acc;
            }, {});
            post.id = v.id;
            posts.push(post);
        }
        dc.close();
        return posts;
    }
    catch (err) {
        console.log('ERROR', err);
        return null;
    }
};
exports.default = getRestaurant;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0UmVzdGF1cmFudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImdldFJlc3RhdXJhbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUE7QUFFbEMsTUFBTSxzQkFBc0IsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFBO0FBQ3BFLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFBO0FBQ3JDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFBO0FBRTlCLE1BQU0sYUFBYSxHQUFHLEtBQUssSUFBSSxFQUFFO0lBQzdCLElBQUksRUFBRSxHQUFHLElBQUksc0JBQXNCLENBQUMsU0FBUyxHQUFHLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQTtJQUMvRCxNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFBO0lBQ3pCLE1BQU0sQ0FBQyxHQUFHLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUE7SUFDMUMsSUFBSTtRQUNGLElBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQTtRQUN0RCxJQUFJLEtBQUssR0FBRyxLQUFLLEVBQUUsQ0FBQTtRQUVuQixLQUFLLE1BQU0sQ0FBQyxJQUFJLElBQUksRUFBRTtZQUNwQixNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDLE1BQU0sRUFBRSxDQUFBO1lBQ3pELElBQUksSUFBSSxHQUFHLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLEVBQUU7Z0JBQzFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQTtnQkFDNUIsT0FBTyxHQUFHLENBQUE7WUFDWixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUE7WUFDTixJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUE7WUFDZCxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFBO1NBQ2pCO1FBRUQsRUFBRSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBQ1YsT0FBTyxLQUFLLENBQUE7S0FDYjtJQUFDLE9BQU8sR0FBRyxFQUFFO1FBQ1YsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUE7UUFDekIsT0FBTyxJQUFJLENBQUE7S0FDZDtBQUNMLENBQUMsQ0FBQTtBQUlELGtCQUFlLGFBQWEsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGdyZW1saW4gPSByZXF1aXJlKCdncmVtbGluJylcclxuXHJcbmNvbnN0IERyaXZlclJlbW90ZUNvbm5lY3Rpb24gPSBncmVtbGluLmRyaXZlci5Ecml2ZXJSZW1vdGVDb25uZWN0aW9uXHJcbmNvbnN0IEdyYXBoID0gZ3JlbWxpbi5zdHJ1Y3R1cmUuR3JhcGhcclxuY29uc3QgdXJpID0gcHJvY2Vzcy5lbnYuUkVBREVSXHJcblxyXG5jb25zdCBnZXRSZXN0YXVyYW50ID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IGRjID0gbmV3IERyaXZlclJlbW90ZUNvbm5lY3Rpb24oYHdzczovLyR7dXJpfS9ncmVtbGluYCwge30pXHJcbiAgICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaCgpXHJcbiAgICBjb25zdCBnID0gZ3JhcGgudHJhdmVyc2FsKCkud2l0aFJlbW90ZShkYylcclxuICAgIHRyeSB7XHJcbiAgICAgIGxldCBkYXRhID0gYXdhaXQgZy5WKCkuaGFzTGFiZWwoJ3Jlc3RhdXJhbnQnKS50b0xpc3QoKVxyXG4gICAgICBsZXQgcG9zdHMgPSBBcnJheSgpXHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHYgb2YgZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IF9wcm9wZXJ0aWVzID0gYXdhaXQgZy5WKHYuaWQpLnByb3BlcnRpZXMoKS50b0xpc3QoKVxyXG4gICAgICAgIGxldCBwb3N0ID0gX3Byb3BlcnRpZXMucmVkdWNlKChhY2MsIG5leHQpID0+IHtcclxuICAgICAgICAgIGFjY1tuZXh0LmxhYmVsXSA9IG5leHQudmFsdWVcclxuICAgICAgICAgIHJldHVybiBhY2NcclxuICAgICAgICB9LCB7fSlcclxuICAgICAgICBwb3N0LmlkID0gdi5pZFxyXG4gICAgICAgIHBvc3RzLnB1c2gocG9zdClcclxuICAgICAgfVxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgIGRjLmNsb3NlKClcclxuICAgICAgcmV0dXJuIHBvc3RzXHJcbiAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnRVJST1InLCBlcnIpXHJcbiAgICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxufVxyXG5cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBnZXRSZXN0YXVyYW50Il19