"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const gremlin = require('gremlin');
const DriverRemoteConnection = gremlin.driver.DriverRemoteConnection;
const Graph = gremlin.structure.Graph;
const uri = process.env.READER;
const restaurantBycuisine = async (cuisine) => {
    let dc = new DriverRemoteConnection(`wss://${uri}/gremlin`, {});
    const graph = new Graph();
    const g = graph.traversal().withRemote(dc);
    try {
        let data = await g.V().hasLabel('restaurant').has('cuisine', cuisine).toList();
        let posts = Array();
        for (const v of data) {
            const _properties = await g.V(v.id).properties().toList();
            let post = _properties.reduce((acc, next) => {
                acc[next.label] = next.value;
                return acc;
            }, {});
            post.id = v.id;
            posts.push(post);
        }
        dc.close();
        return posts;
    }
    catch (err) {
        console.log('ERROR', err);
        return null;
    }
};
exports.default = restaurantBycuisine;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0UmVzdGF1cmFudEJ5Y3Vpc2luZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImdldFJlc3RhdXJhbnRCeWN1aXNpbmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUE7QUFFbEMsTUFBTSxzQkFBc0IsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLHNCQUFzQixDQUFBO0FBQ3BFLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFBO0FBQ3JDLE1BQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFBO0FBSzlCLE1BQU0sbUJBQW1CLEdBQUcsS0FBSyxFQUFFLE9BQWMsRUFBRSxFQUFFO0lBQ2pELElBQUksRUFBRSxHQUFHLElBQUksc0JBQXNCLENBQUMsU0FBUyxHQUFHLFVBQVUsRUFBRSxFQUFFLENBQUMsQ0FBQTtJQUMvRCxNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFBO0lBQ3pCLE1BQU0sQ0FBQyxHQUFHLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDLENBQUE7SUFDMUMsSUFBSTtRQUNGLElBQUksSUFBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxFQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFBO1FBQzdFLElBQUksS0FBSyxHQUFHLEtBQUssRUFBRSxDQUFBO1FBRW5CLEtBQUssTUFBTSxDQUFDLElBQUksSUFBSSxFQUFFO1lBQ3BCLE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUMsTUFBTSxFQUFFLENBQUE7WUFDekQsSUFBSSxJQUFJLEdBQUcsV0FBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsRUFBRTtnQkFDMUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFBO2dCQUM1QixPQUFPLEdBQUcsQ0FBQTtZQUNaLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQTtZQUNOLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQTtZQUNkLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUE7U0FDakI7UUFFRCxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUE7UUFDVixPQUFPLEtBQUssQ0FBQTtLQUNiO0lBQUMsT0FBTyxHQUFHLEVBQUU7UUFDVixPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQTtRQUN6QixPQUFPLElBQUksQ0FBQTtLQUNkO0FBQ0wsQ0FBQyxDQUFBO0FBSUQsa0JBQWUsbUJBQW1CLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBncmVtbGluID0gcmVxdWlyZSgnZ3JlbWxpbicpXHJcblxyXG5jb25zdCBEcml2ZXJSZW1vdGVDb25uZWN0aW9uID0gZ3JlbWxpbi5kcml2ZXIuRHJpdmVyUmVtb3RlQ29ubmVjdGlvblxyXG5jb25zdCBHcmFwaCA9IGdyZW1saW4uc3RydWN0dXJlLkdyYXBoXHJcbmNvbnN0IHVyaSA9IHByb2Nlc3MuZW52LlJFQURFUlxyXG5cclxuXHJcblxyXG5cclxuY29uc3QgcmVzdGF1cmFudEJ5Y3Vpc2luZSA9IGFzeW5jIChjdWlzaW5lOlN0cmluZykgPT4ge1xyXG4gICAgbGV0IGRjID0gbmV3IERyaXZlclJlbW90ZUNvbm5lY3Rpb24oYHdzczovLyR7dXJpfS9ncmVtbGluYCwge30pXHJcbiAgICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaCgpXHJcbiAgICBjb25zdCBnID0gZ3JhcGgudHJhdmVyc2FsKCkud2l0aFJlbW90ZShkYylcclxuICAgIHRyeSB7XHJcbiAgICAgIGxldCBkYXRhID0gYXdhaXQgZy5WKCkuaGFzTGFiZWwoJ3Jlc3RhdXJhbnQnKS5oYXMoJ2N1aXNpbmUnLGN1aXNpbmUpLnRvTGlzdCgpXHJcbiAgICAgIGxldCBwb3N0cyA9IEFycmF5KClcclxuXHJcbiAgICAgIGZvciAoY29uc3QgdiBvZiBkYXRhKSB7XHJcbiAgICAgICAgY29uc3QgX3Byb3BlcnRpZXMgPSBhd2FpdCBnLlYodi5pZCkucHJvcGVydGllcygpLnRvTGlzdCgpXHJcbiAgICAgICAgbGV0IHBvc3QgPSBfcHJvcGVydGllcy5yZWR1Y2UoKGFjYywgbmV4dCkgPT4ge1xyXG4gICAgICAgICAgYWNjW25leHQubGFiZWxdID0gbmV4dC52YWx1ZVxyXG4gICAgICAgICAgcmV0dXJuIGFjY1xyXG4gICAgICAgIH0sIHt9KVxyXG4gICAgICAgIHBvc3QuaWQgPSB2LmlkXHJcbiAgICAgICAgcG9zdHMucHVzaChwb3N0KVxyXG4gICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgZGMuY2xvc2UoKVxyXG4gICAgICByZXR1cm4gcG9zdHNcclxuICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdFUlJPUicsIGVycilcclxuICAgICAgICByZXR1cm4gbnVsbFxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJlc3RhdXJhbnRCeWN1aXNpbmUiXX0=